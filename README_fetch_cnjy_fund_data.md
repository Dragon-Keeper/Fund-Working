# 场内交易基金数据抓取工具

## 功能概述

本工具使用 Playwright 库从东方财富网抓取场内交易基金数据，并将数据存储到 HDF5 数据库中。支持获取所有基金数据和按基金代码查询的功能。

## 提取字段

工具从网页表格的第4个单元格（索引3）开始，提取到第14个单元格（索引13），并按顺序映射为以下11项信息：

1. **基金代码** (fund_code)
2. **基金简称** (fund_name)
3. **基金类型** (fund_type)
4. **最新单位净值** (latest_unit_nav)
5. **最新累计净值** (latest_accum_nav)
6. **上个交易日单位净值** (prev_unit_nav)
7. **上个交易日累计净值** (prev_accum_nav)
8. **增长值** (growth_value)
9. **增长率** (growth_rate)
10. **市价** (market_price)
11. **折价率** (discount_rate)

对于不存在的数据，使用 "---" 进行填充。

## 使用方法

### 1. 安装依赖

```bash
pip install playwright pandas h5py
playwright install
```

### 2. 运行程序

```bash
python fetch_cnjy_fund_data.py
```

### 3. 菜单选项

运行后会显示以下菜单：

```
=== 场内交易基金数据工具 ===
1. 下载所有基金数据
2. 按基金代码查询
0. 退出
请选择操作 (0-2): 
```

- **选项1**: 从东方财富网抓取所有场内交易基金数据并存储到 HDF5 数据库
- **选项2**: 输入基金代码查询特定基金的数据
- **选项0**: 退出程序

## 数据存储

数据将存储在以下位置：

```
data/CNJY_Fund_Data.h5
```

## 注意事项

1. 程序使用 headless 模式运行浏览器，不会显示浏览器界面
2. 数据抓取可能受到网站结构变化的影响
3. 如果抓取失败，请检查网络连接或网站是否可访问
4. 程序会自动处理表格定位问题，支持多种选择器尝试
5. 当前页面只包含一页数据，程序将直接获取所有数据

## 错误处理

- 如果未找到基金数据表格，程序会尝试多种选择器并给出相应提示
- 对于数据缺失的字段，会使用 "---" 进行填充
- 程序会过滤掉不符合格式的数据行，确保数据完整性